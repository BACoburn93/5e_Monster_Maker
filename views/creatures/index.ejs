<% layout('layouts/boilerplate') %>

<h1 class="text-center mb-5">Creatures</h1>

<div class="table">

</div>

<table class="table table-sortable" id="creatureIndex">
    <thead>
        <tr>
            <th scope="col" onclick="sortTable(0)">Name</th>
            <th scope="col" onclick="sortTable(1)">Challenge Rating</th>
            <th scope="col" onclick="sortTable(2)">Size</th>
            <th scope="col" onclick="sortTable(3)">Type</th>
            <th scope="col" onclick="sortTable(4)">Alignment</th>
            <th scope="col" onclick="sortTable(5)">Environment</th>
        </tr>
    </thead>
    <tbody>
        <% for (let creature of creatures){%>
        <% if(creature.sharable === true || currentUser && creature.author.equals(currentUser._id)) {%>
        <tr>
            <td scope="row">
                <a href="/creatures/<%= creature._id %>">
                    <%= creature.name %>
                </a>

            </td>
            <td scope="row">
                <a href="/creatures/<%= creature._id %>">
                    <%= creature.cr %>
                </a>
            </td>
            <td scope="row">
                <a href="/creatures/<%= creature._id %>">
                    <%= creature.size %>
                </a>
            </td>
            <td scope="row">
                <a href="/creatures/<%= creature._id %>">
                    <%= creature.creatureType %>
                </a>
            </td>
            <td scope="row">
                <a href="/creatures/<%= creature._id %>">
                    <%= creature.alignment %>
                </a>
            </td>
            <td scope="row">
                <a href="/creatures/<%= creature._id %>">
                    <%= creature.environment[0] %>
                </a>
            </td>
            <td scope="row">
                <%  if( currentUser && creature.author.equals(currentUser._id))  {%>
                <div class="card-body">
                    <a class="card-link btn btn-info" href="/creatures/<%= creature._id %>/edit">Edit</a>
                    <form class="d-inline" action="/creatures/<%=creature._id%>?_method=DELETE" method="POST">
                        <button class="card-link btn btn-danger"
                            onclick="return confirm('Are you sure you want to delete this item?');">Delete</button>
                    </form>
                </div>
                <% }%>
            </td>


        </tr>
        <% }%>
        <% }%>
    </tbody>
</table>

<button class="btn btn-success mb-3">
    <a href="/creatures/new">Add Creature</a>
</button>


</div>